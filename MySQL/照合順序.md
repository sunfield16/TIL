# 照合順序
照合順序（Collation）は、[[文字セット]]内の文字を比較するためのルール。  
この比較ルールによって、`WHERE`で文字列を比較した際の結果や`ORDER BY`でのソート順が変わる。

例えば、
* 文字列で`A`と`B`を比較する時にどのような比較を行うか
* 文字列の大文字・小文字を区別するか

などのルールが照合順序によって決まる。

各文字セットには必ず対応する照合順序が1つ以上あり、  
文字セットごとにデフォルトの照合順序が存在する。  
（`文字セット:照合順序 = 1:n`みたいなイメージ）

`SHOW COLLATION`で使用可能な全ての照合順序を確認できる。

## 照合順序による影響のイメージ
<https://dev.mysql.com/doc/refman/8.0/ja/charset-collation-effect.html>

## 命名規則
照合順序は基本的にこのような形式になっている。  
```
[文字コード]_[言語]_[比較ルール]
```

* 文字コード ... `utf8mb4`や`latin1`など
* 言語 ... `japanese`など言語を表す
  - utf8などのマルチリンガルな文字コードでは`general`や`unicode`などもある
* 比較ルール ... どのようなルールで比較を行うかの特徴
  - `ci, cs` ... 大文字・小文字を区別するかどうか（ci -> 区別しない、cs -> 区別する）
  - `ks` ... カナを区別する
  - `bin` ... バイナリでの比較をする

## デフォルト
システム変数により、デフォルトの照合順序を変更可能。

<https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html>

* `collation_connection` ... 接続時の文字セットに対する照合順序
  - 文字リテラルの照合に使われる
* `collation_database` ... デフォルトのデータベースで使われる照合順序
  - これはサーバーによって設定されるもので、手動で設定してはいけないとされている
  - MySQL5.7では非推奨の変数になった
* `collation_server` ... サーバーのデフォルトの照合順序
  - デフォルトの文字セット（`character_set_server`）に対応しているものを設定する必要がある