# 概要
プログラミングには様々な設計手法があるが、それを正しく理解するために必要な    
大前提の部分について記載する。

# 参考資料
プログラミング設計思考の基礎の基礎の基礎  
https://qiita.com/nabepon/items/347a1aae97caf2a87027

## 設計の必要性
* 一言で表すと、 **ソースコードの複雑性を下げる** ため
* 保守しやすくしたり拡張性を高めたりするというのもあるが、究極的には  
  複雑性を下げるということ


## アプリケーションを構成する３つの要素
アプリケーションの処理は必ず以下の3つから構成される。  

* 状態
  - つまりデータのことで、入力になるもの
* 表示
  - 状態を出力する（画面、ファイル等）
* 副作用
  - 状態を変更する

Webアプリケーションで例えるならば以下のようになる。

* 状態（データベース）
* 表示（html出力）
* 副作用（サーバー通信等によるデータベース更新）

とにかく、この3要素に分けることが重要。  
分けることで設計ができるようになる。

## アプリケーション作成の基本
アプリケーション作成の根幹は、**処理をパーツに分解して組み合わせる**ことにある。  
どんなアプリケーションであってもここが変わることはない。

### パーツとは
* 関数
* クラス
* モジュール
* コンポーネント
* ライブラリ
* パッケージ
* マイクロサービス
* アプリケーション

パーツになるものは多岐にわたり、アプリケーションもパーツになり得る。  
もちろんAPIがあって、組み合わせることで初めてアプリケーションが成立する。

### パーツを組み合わせる
1. 処理をパーツに分解する
2. パーツを操作するためのインターフェース（=API）を作成する
3. パーツ同士を組み合わせる

これを上手くやることが「設計」であり、上手くできるほど  
ソースコードの複雑性を下げることにつながる。


## 具体的な法則
### 関心の分離
そのクラスや関数が、何に関心を持つかどうかを意識する。  
「関心事」を分離することがパーツの分離につながる。

### 参照透過性
参照を意識しなくていい、不変であるという性質。  
変数であれば「再代入されない」こと、  
関数であれば「同じ入力をする限り同じ出力になる」といったイメージ。

### 名前重要
名前を適切につけるためには、適切な分離が重要である。

### KISS原則
シンプルにしておきましょうという原則。  

根本的な設計を上手くやるのが重要であり、それ以外の部分で頑張っても  
あまり影響しないことが多い。  
瑣末な部分を頑張って設計するよりは、シンプルにしておくのが良い。

### テスト容易性
テストがしやすいコードは適切に分離されている。  
テストのしやすさを意識して作ると、結果的によい設計になる。

### 条件分岐の宣言化
状態と処理を切り分けて、宣言的なコードを作る方が良い。

例えばif文のネストが深い場合、その処理よりも手前で条件分岐を事前に整理して  
シンプルなif文だけで済ませるようにする。

### リソースの単一性
* 状態は1箇所にまとめる
* 状態の参照先は1つにする

### インターフェースの最小化
* 引数になんでもかんでも渡さず、必要最低限にする
* 引数に渡すものが少なくなるように作る
* 外部のクラス等を知らなくていいようなインターフェースを作る

引数が多いということは、外部でやるべきことをやってしまっている可能性が高い。

### 副作用の非循環
副作用は1回で済むようにし、副作用によって別の副作用が起きることは可能な限り避ける。

1. データを取得する
2. 状態を変更する
3. 変更がトリガーになって副作用が発生する
4. 別のデータを取得する
5. 状態を変更する
6. 変更がトリガーになって副作用が発生する

...

副作用から別の副作用につながるのは必要になることもあるが、  
このような無限ループが発生しないように管理することが重要。